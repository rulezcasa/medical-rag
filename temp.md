# CardBuzz AI - System Architecture

## High-Level System Architecture Diagram


<img width="3860" height="4004" alt="Untitled Diagram" src="https://github.com/user-attachments/assets/50e642fd-377e-4c49-83fa-0d7046d78c19" />




## Component Descriptions

### Frontend Layer
- **Framework**: Next.js 14 with React 18
- **UI**: TailwindCSS, Framer Motion
- **Authentication**: Supabase Auth UI
- **Key Pages**:
  - Dashboard/Portfolio Management
  - Card Discovery & Search
  - AI Recommender
  - Blog System
  - Admin Panel

### Backend API Layer
- **Framework**: Express.js with TypeScript
- **Architecture**: MVC Pattern (Routes → Controllers → Services)
- **Security**: JWT, CORS, Helmet, Rate Limiting
- **Key Routes**:
  - `/api/cards` - Card catalog and search
  - `/api/ai/*` - AI-powered services
  - `/api/portfolio` - User portfolio management
  - `/api/blogs` - Blog content management
  - `/api/admin` - Administrative functions

### AI Services Layer
All AI services extend `BaseAIService` and use Google Gemini AI:

1. **PortfolioInsightsService** - Analyze user's credit card portfolio
2. **HiddenPerksService** - Uncover hidden card benefits
3. **PointsOptimizerService** - Optimize reward points usage
4. **FinancialGoalsService** - Provide financial goal guidance
5. **OfferAnalyzerService** - Analyze credit card offers
6. **TncDecoderService** - Simplify terms & conditions
7. **CreditHealthService** - Assess credit health
8. **CardComparisonService** - Compare multiple cards
9. **FindPerfectCardService** - Match cards to user needs
10. **ExpenseTrackingService** - Track and analyze expenses
11. **PortfolioRecommendationService** - Recommend portfolio changes
12. **BlogGenerationService** - Generate blog content
13. **AirportLoungeSQLService** - Query lounge access information
14. **GeneralChatService** - General purpose AI chat
15. **VectorRecommendationService** - Semantic card recommendations using embeddings
16. **PerplexitySearchService** - Web search for card facts

### Data Layer

#### PostgreSQL (via Prisma)
- Primary relational database
- Stores: cards, user profiles, portfolios, blogs, comments, lounge data
- Managed with Prisma ORM

#### MongoDB
- Stores detailed card information
- Includes: fees, charges, rewards, benefits, eligibility criteria
- Used for rich card details not in PostgreSQL

#### Qdrant (Vector Database)
- Stores card embeddings generated by Google Gemini
- Enables semantic search and recommendations
- Used by VectorRecommendationService

### External Services

1. **Supabase**
   - Authentication service
   - User management
   - Session handling

2. **Google Gemini AI**
   - Primary AI/ML service
   - Text generation, embeddings
   - Used by all AI services

3. **Perplexity AI**
   - Web search API
   - Real-time card information fetching
   - Used for up-to-date card facts

4. **Google Cloud Storage**
   - File and image storage
   - Card images, user uploads

### Deployment

- **Platform**: Google Cloud Platform (GCP)
- **Container Runtime**: Cloud Run
- **CI/CD**: Cloud Build
- **Containerization**: Docker
- **Orchestration**: PM2 (for process management)

## Data Flow Examples

### Card Recommendation Flow
```
User → Frontend → /api/ai/find-perfect-card → FindPerfectCardService 
→ Gemini AI + PostgreSQL + MongoDB → Response → Frontend → User
```

### Vector Search Flow
```
User Query → VectorRecommendationService → Gemini Embedding Model 
→ Generate Embedding → Qdrant Vector Search → Match Cards → Return Results
```

### Blog Generation Flow
```
Admin → Frontend → /api/ai/generate-blog → BlogGenerationService 
→ Gemini AI + Card Data → Generated Blog → Save to PostgreSQL → Return
```

## Security Considerations

- JWT-based authentication via Supabase
- CORS configuration
- Rate limiting on API endpoints
- Helmet.js for HTTP security headers
- Environment variables for sensitive data
- HTTPS only in production

